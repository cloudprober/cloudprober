
probe {
    name: "drive_api"
    type: HTTP

    interval: "10s"
    timeout: "5s"

    targets {
        host_names: "www.googleapis.com"
    }

    http_probe {
        protocol: HTTPS
        relative_url: "/drive/v2/files"
        oauth_config {
            http_request {
                token_url: "https://accounts.google.com/o/oauth2/token"
                method: "POST"
                data: "client_id={{env "API_CLIENT_ID"}}"
                data: "client_secret={{env "API_CLIENT_SECRET"}}"
                data: "refresh_token={{env "REFRESH_TOKEN"}}"
                data: "grant_type=refresh_token"
            }
        }
    }

    validator {
        name: "status_code_200"
        http_validator {
            success_status_codes: "200"
        }
    }
}

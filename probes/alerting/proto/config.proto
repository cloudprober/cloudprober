syntax = "proto3";

package cloudprober.probes.alerts;

option go_package = "github.com/cloudprober/cloudprober/probes/alerting/proto";


// Notify is not implemented yet. We just log a warning when there is an alert.
message Notify {
    // Command to run when alert is fired. In the command line following fields
    // are substituted:
    //  @alert@: Alert name
    //  @probe@: Probe name
    //  @target@: Target name, or target and port if port is specified.
    //  @target.label.<label>@: Label <label> value, e.g. target.label.role.
    //  @value@: Value that triggered the alert.
    //  @threshold@: Threshold that was crossed.
    //  @since@: Time since the alert condition started.
    string command = 1;
}

message AlertConf {
    // Name of the alert. Default is to use the probe name.
    string name = 1;

    // Thresholds for the alert.
    float failure_threshold = 2;

    // Duration threshold in seconds. If duration_threshold_sec is set, alert
    // will be fired only if alert condition is true for
    // duration_threshold_sec.
    optional int32 duration_threshold_sec = 3;

    // How to notify in case of alert.
    Notify notify = 4;
}

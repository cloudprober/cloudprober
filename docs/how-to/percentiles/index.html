<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://cloudprober.org/fonts/open-sans/open-sans-v35-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/open-sans/open-sans-v35-latin-italic.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/open-sans/open-sans-v35-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/jost/jost-v14-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/jost/jost-v14-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/jost/jost-v14-latin-italic.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://cloudprober.org/main.b56984fec46c3d7a6da42898038ee6c05f5386fad2b5521c7d225290454d5d60663e5ed4443db6222473e12a20bfca5c19931b499ca8ee8cb967f74a43aa4ef6.css integrity="sha512-tWmE/sRsPXptpCiYA47mwF9ThvrStVIcfSJSkEVNXWBmPl7URD22IiRz4Sogv8pcGZMbSZyo7oy5Z/dKQ6pO9g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Percentiles, Histograms, and Distributions - Cloudprober</title><meta name=description content="Percentiles give you a deeper insight into how your system is behaving. For example, if your application&amp;rsquo;s response latency is very low 94 times out 100 but very high for the remaining 6 times, your average latency will still be low but it won&amp;rsquo;t be a great experience for your users. In other words, this is the case where your 95th percentile latency is high, even though your average and median (50th-%ile) latency is very low."><link rel=canonical href=https://cloudprober.org/docs/how-to/percentiles/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Percentiles, Histograms, and Distributions"><meta property="og:description" content="Percentiles give you a deeper insight into how your system is behaving. For example, if your application&rsquo;s response latency is very low 94 times out 100 but very high for the remaining 6 times, your average latency will still be low but it won&rsquo;t be a great experience for your users. In other words, this is the case where your 95th percentile latency is high, even though your average and median (50th-%ile) latency is very low."><meta property="og:url" content="https://cloudprober.org/docs/how-to/percentiles/"><meta property="og:site_name" content="Cloudprober"><meta property="article:published_time" content="2022-09-01T17:24:32-07:00"><meta property="article:modified_time" content="2022-09-01T17:24:32-07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@cloudprober"><meta name=twitter:creator content="@manugarg"><meta name=twitter:title content="Percentiles, Histograms, and Distributions"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Percentiles, Histograms, and Distributions"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://cloudprober.org/#/schema/organization/1","name":"Cloudprober","url":"https://cloudprober.org/","sameAs":["https://twitter.com/cloudprober","https://github.com/cloudprober/cloudprober"],"logo":{"@type":"ImageObject","@id":"https://cloudprober.org/#/schema/image/1","url":"https://cloudprober.org/\u003cnil\u003e","width":512,"height":512,"caption":"Cloudprober"},"image":{"@id":"https://cloudprober.org/#/schema/image/1"}},{"@type":"WebSite","@id":"https://cloudprober.org/#/schema/website/1","url":"https://cloudprober.org/","name":"Cloudprober","description":"An active\/synthetic monitoring software to reliably detect outages before your customers do.","publisher":{"@id":"https://cloudprober.org/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://cloudprober.org/docs/how-to/percentiles/","url":"https://cloudprober.org/docs/how-to/percentiles/","name":"Percentiles, Histograms, and Distributions","description":"","isPartOf":{"@id":"https://cloudprober.org/#/schema/website/1"},"about":{"@id":"https://cloudprober.org/#/schema/organization/1"},"datePublished":"2022-09-01T17:24:32CET","dateModified":"2022-09-01T17:24:32CET","breadcrumb":{"@id":"https://cloudprober.org/docs/how-to/percentiles/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://cloudprober.org/docs/how-to/percentiles/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://cloudprober.org/docs/how-to/percentiles/"]}]},{"@type":"BreadcrumbList","@id":"https://cloudprober.org/docs/how-to/percentiles/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://cloudprober.org","url":"https://cloudprober.org","name":"Home"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://cloudprober.org/docs/","url":"https://cloudprober.org/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://cloudprober.org/docs/how-to/","url":"https://cloudprober.org/docs/how-to/","name":"How To"}},{"@type":"ListItem","position":5,"item":{"@id":"https://cloudprober.org/docs/how-to/percentiles/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://cloudprober.org/#/schema/article/1","headline":"Percentiles, Histograms, and Distributions","description":"","isPartOf":{"@id":"https://cloudprober.org/docs/how-to/percentiles/"},"mainEntityOfPage":{"@id":"https://cloudprober.org/docs/how-to/percentiles/"},"datePublished":"2022-09-01T17:24:32CET","dateModified":"2022-09-01T17:24:32CET","author":{"@id":"https://cloudprober.org/#/schema/person/2"},"publisher":{"@id":"https://cloudprober.org/#/schema/organization/1"},"image":{"@id":"https://cloudprober.org/docs/how-to/percentiles/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://cloudprober.org/#/schema/person/2","name":"Manu Garg","sameAs":["https://twitter.com/manugarg","https://www.linkedin.com/in/manugarg/","https://github.com/manugarg"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://cloudprober.org/docs/how-to/percentiles/#/schema/image/2","url":null,"contentUrl":null,"caption":"Percentiles, Histograms, and Distributions"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://cloudprober.org/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://cloudprober.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://cloudprober.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://cloudprober.org/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://cloudprober.org/site.webmanifest><script async src="https://www.googletagmanager.com/gtag/js?id=G-FHHPC1TNQV"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FHHPC1TNQV")</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-79661-8","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var buttons=document.querySelectorAll("a"),query;Array.prototype.map.call(buttons,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-action")||"follow";ga("send","event","outbound",t,e.href)})}),query=document.querySelector(".query"),query&&query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script></head><body class="docs single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://cloudprober.org/ aria-label=Cloudprober>Cloudprober</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://cloudprober.org/>Cloudprober</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/overview/cloudprober>Get Started</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/config/overview>Configuration</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/how-to/external-probe>How-To</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/about/>About</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/cloudprober/cloudprober><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://join.slack.com/t/cloudprober/shared_invite/enQtNjA1OTkyOTk3ODc3LWQzZDM2ZWUyNTI0M2E4NmM4NTIyMjM5M2E0MDdjMmU1NGQ3NWNiMjU4NTViMWMyMjg0M2QwMDhkZGZjZmFlNGE><svg xmlns="http://www.w3.org/2000/svg" class="feather social-slack" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.08 9C19.81 1.41 16.54-.35 9 1.92S-.35 7.46 1.92 15 7.46 24.35 15 22.08 24.35 16.54 22.08 9z"/><line x1="12.57" y1="5.99" x2="16.15" y2="16.39"/><line x1="7.85" y1="7.61" x2="11.43" y2="18.01"/><line x1="16.39" y1="7.85" x2="5.99" y2="11.43"/><line x1="18.01" y1="12.57" x2="7.61" y2="16.15"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/overview/cloudprober>Overview</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/overview/getting-started/>Getting Started</a></li><li><a class=docs-link href=https://cloudprober.org/docs/overview/probe/>What is a Probe</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/config/overview>Configuration</a></h3><h3 class="h6 text-uppercase mb-2"><a class="docs-link active" href=https://cloudprober.org/docs/how-to/external-probe>How-To</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/how-to/external-probe/>External Probe</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/alerting/>Alerting</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/targets/>Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/k8s_targets/>Kubernetes Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/run-on-kubernetes/>Running On Kubernetes</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/additional-labels/>Additional Labels</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/validators/>Validators</a></li><li><a class="docs-link active" href=https://cloudprober.org/docs/how-to/percentiles/>Percentiles and Histograms</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/built-in-servers/>Built-in Servers</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/extensions/>Extending Cloudprober</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/rds/>Resource Discovery Service</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview/>Exporting Metrics (Surfacers)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/cloudwatch/>Cloudwatch (AWS)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/stackdriver/>Stackdriver (Google Cloud)</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav id=sidebar-default class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/overview/cloudprober>Overview</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/overview/getting-started/>Getting Started</a></li><li><a class=docs-link href=https://cloudprober.org/docs/overview/probe/>What is a Probe</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/config/overview>Configuration</a></h3><h3 class="h6 text-uppercase mb-2"><a class="docs-link active" href=https://cloudprober.org/docs/how-to/external-probe>How-To</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/how-to/external-probe/>External Probe</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/alerting/>Alerting</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/targets/>Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/k8s_targets/>Kubernetes Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/run-on-kubernetes/>Running On Kubernetes</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/additional-labels/>Additional Labels</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/validators/>Validators</a></li><li><a class="docs-link active" href=https://cloudprober.org/docs/how-to/percentiles/>Percentiles and Histograms</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/built-in-servers/>Built-in Servers</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/extensions/>Extending Cloudprober</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/rds/>Resource Discovery Service</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview/>Exporting Metrics (Surfacers)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/cloudwatch/>Cloudwatch (AWS)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/stackdriver/>Stackdriver (Google Cloud)</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#histograms-in-cloudprober-distributions>Histograms in Cloudprober (Distributions)</a></li><li><a href=#configuring-distributions>Configuring distributions</a></li><li><a href=#percentiles-and-heatmap>Percentiles and Heatmap</a><ul><li><a href=#stackdriver-google-cloud-monitoring>Stackdriver (Google Cloud Monitoring)</a></li><li><a href=#prometheus>Prometheus</a></li></ul></li><li><a href=#more-resources>More Resources</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#histograms-in-cloudprober-distributions>Histograms in Cloudprober (Distributions)</a></li><li><a href=#configuring-distributions>Configuring distributions</a></li><li><a href=#percentiles-and-heatmap>Percentiles and Heatmap</a><ul><li><a href=#stackdriver-google-cloud-monitoring>Stackdriver (Google Cloud Monitoring)</a></li><li><a href=#prometheus>Prometheus</a></li></ul></li><li><a href=#more-resources>More Resources</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Percentiles, Histograms, and Distributions</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#histograms-in-cloudprober-distributions>Histograms in Cloudprober (Distributions)</a></li><li><a href=#configuring-distributions>Configuring distributions</a></li><li><a href=#percentiles-and-heatmap>Percentiles and Heatmap</a><ul><li><a href=#stackdriver-google-cloud-monitoring>Stackdriver (Google Cloud Monitoring)</a></li><li><a href=#prometheus>Prometheus</a></li></ul></li><li><a href=#more-resources>More Resources</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#histograms-in-cloudprober-distributions>Histograms in Cloudprober (Distributions)</a></li><li><a href=#configuring-distributions>Configuring distributions</a></li><li><a href=#percentiles-and-heatmap>Percentiles and Heatmap</a><ul><li><a href=#stackdriver-google-cloud-monitoring>Stackdriver (Google Cloud Monitoring)</a></li><li><a href=#prometheus>Prometheus</a></li></ul></li><li><a href=#more-resources>More Resources</a></li></ul></nav></div></nav><p>Percentiles give you a deeper insight into how your system is behaving. For example, if your application&rsquo;s response latency is very low 94 times out 100 but very high for the remaining 6 times, your average latency will still be low but it won&rsquo;t be a great experience for your users. In other words, this is the case where your 95th percentile latency is high, even though your average and median (50th-%ile) latency is very low.</p><p>A typical way to measure percentiles from continuous monitoring data, which you may have to aggregate across various sources, is to use histograms (also called, distributions). In a histogram, you assign the incoming data points (samples) to pre-defined buckets. Each data point increases the count for the bucket that it falls into; data point itself is discarded after that. You can take a look at the bucket counts at any point of time and get an estimate of the percentiles. Histograms make it easy to aggregate data across multiple entities, for example, from probes running on multiple machines.</p><p>Following diagram shows distribution of latencies into 9 equal sized histogram buckets:</p><p><img class="img-fluid lazyload blur-up" srcset="https://cloudprober.org/docs/how-to/percentiles/latency_distribution_hu3be56c45b019bb7f7f6d269fd80a40dd_7227_d0bff7f33466346c93eee5d79c2d65c8.webp 480w, https://cloudprober.org/docs/how-to/percentiles/latency_distribution_hu3be56c45b019bb7f7f6d269fd80a40dd_7227_509x0_resize_q75_h2_box_3.webp 509w" sizes=80vw src=https://cloudprober.org/docs/how-to/percentiles/latency_distribution_hu3be56c45b019bb7f7f6d269fd80a40dd_7227_509x0_resize_q75_h2_box_3.webp alt="Distribution of Latencies" title="Histogram for the samples" width=509 height=280></p><p>(<em>Above diagram shows histogram for the following samples:
5.1, 6.2, 9.0, 12.1, 8.3, 9.7, 9.4, 10.3, 14.1, 11.2, 16.6, 9.9, 10.6, 14.1, 0.9, 7.1, 17.7</em>)</p><h2 id=histograms-in-cloudprober-distributions>Histograms in Cloudprober (Distributions) <a href=#histograms-in-cloudprober-distributions class=anchor aria-hidden=true>#</a></h2><p>Cloudprober uses a metric type called &lsquo;distribution&rsquo; to create and export histograms. Cloudprober supports creating distributions for probe latencies, and for metrics generated from external probe payloads. To create distributions, you have to specify how the data should be bucketed &ndash; you can either explicitly specify all bucket bounds, or use exponential buckets type which generates bucket bounds from only a few variables.</p><p>Here is an example of using explicit buckets for latencies:</p><pre><code>probe {
  name: &quot;...&quot;
  type: HTTP
  targets {
    host_names: &quot;...&quot;
  }

  latency_unit: &quot;ms&quot;
  latency_distribution {
    explicit_buckets: &quot;0.01,0.1,0.15,0.2,0.25,0.35,0.5,0.75,1.0,1.5,2.0,3.0,4.0,5.0,10.0,15.0,20.0&quot;
  }
}
</code></pre><h2 id=configuring-distributions>Configuring distributions <a href=#configuring-distributions class=anchor aria-hidden=true>#</a></h2><p>As seen in the example above, for latencies you configure distribution at the probe level by adding a field called <code>latency_distribution</code>. Without this field, cloudprober exports only cumulative latencies. To create distributions from an external probe&rsquo;s data, take a look at the external probe&rsquo;s <a href=https://cloudprober.org/how-to/external-probe/#distributions>documentation</a>.</p><p>Format for the distribution field is in turn defined in <a href=https://github.com/cloudprober/cloudprober/blob/master/metrics/proto/dist.proto>dist.proto</a>.</p><pre><code class=language-proto>// Dist defines a Distribution data type.
message Dist {
  oneof buckets {
    // Comma-separated list of lower bounds, where each lower bound is a float
    // value. Example: 0.5,1,2,4,8.
    string explicit_buckets = 1;

    // Exponentially growing buckets
    ExponentialBuckets exponential_buckets = 2;
  }
}

// ExponentialBucket defines a set of num_buckets+2 buckets:
//   bucket[0] covers (−Inf, 0)
//   bucket[1] covers [0, scale_factor)
//   bucket[2] covers [scale_factor, scale_factor*base)
//   ...
//   bucket[i] covers [scale_factor*base^(i−2), scale_factor*base^(i−1))
//   ...
//   bucket[num_buckets+1] covers [scale_factor*base^(num_buckets−1), +Inf)
// Note: Base must be at least 1.01.
message ExponentialBuckets {
  optional float scale_factor = 1 [default = 1.0];
  optional float base = 2 [default = 2];
  optional uint32 num_buckets = 3 [default = 20];
}
</code></pre><h2 id=percentiles-and-heatmap>Percentiles and Heatmap <a href=#percentiles-and-heatmap class=anchor aria-hidden=true>#</a></h2><p>Now that we&rsquo;ve configured cloudprober to generate distributions, how do we make use of this new information. This depends on the monitoring system (prometheus, stackdriver, postgres, etc) you&rsquo;re exporting your data to.</p><p>Both prometheus and <a href=https://cloudprober.org/surfacers/stackdriver/>stackdriver</a> support computing and plotting percentiles from the distributions data. Stackdriver can natively create heatmaps from distributions while for prometheus you need to use grafana to create heatmaps.</p><h3 id=stackdriver-google-cloud-monitoring>Stackdriver (Google Cloud Monitoring) <a href=#stackdriver-google-cloud-monitoring class=anchor aria-hidden=true>#</a></h3><p>Stackdriver automatically shows percentile aggregator for distribution metrics in metrics explorer (<a href=https://cloudprober.org/diagrams/metrics_explorer_percentile.png>example</a>). You can also use Stackdriver MQL to create percentiles (see <a href=https://cloudprober.org/surfacers/stackdriver/#accessing-the-data>stackdriver documentation</a> for other usages of MQL for cloudprober metrics):</p><pre><code class=language-shell>fetch gce_instance
| metric 'custom.googleapis.com/cloudprober/http/google_homepage/latency'
| filter (resource.zone == 'us-central1-a')
| align delta(1m)
| every 1m
| group_by [resource.zone], [value_latency_percentile: percentile(value.latency, 95)]
</code></pre><p>Stackdriver has <a href=https://cloud.google.com/monitoring/charts/charting-distribution-metrics>detailed documentation</a> on charting distributions.</p><h3 id=prometheus>Prometheus <a href=#prometheus class=anchor aria-hidden=true>#</a></h3><p>Cloudprober surfaces distributions to prometheus as prometheus metric type <a href=https://prometheus.io/docs/concepts/metric_types/#histogram>histogram</a>. Here is an example of prometheus metrics page created by cloudprober:</p><pre><code class=language-bash># TYPE latency histogram
latency_sum{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;} 77557.14022499947 1607766316442
latency_count{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;} 172150 1607766316442
latency_bucket{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;,le=&quot;0.01&quot;} 0 1607766316442
latency_bucket{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;,le=&quot;0.1&quot;} 0 1607766316442
...
...
latency_bucket{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;,le=&quot;75&quot;} 172150 1607766316442
latency_bucket{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;,le=&quot;100&quot;} 172150 1607766316442
latency_bucket{ptype=&quot;http&quot;,probe=&quot;my_probe&quot;,dst=&quot;hostA&quot;,le=&quot;+Inf&quot;} 172150 1607766316442
</code></pre><p>Fortunately there is already a plenty of good documentation on how to make use of histograms in prometheus and grafana:</p><ul><li><a href=https://grafana.com/blog/2020/06/23/how-to-visualize-prometheus-histograms-in-grafana/>Grafana blog</a> on how to visualize prometheus histograms in grafana.</li><li>Prometheus documentation on <a href=https://prometheus.io/docs/practices/histograms/>histrograms</a>.</li></ul><h2 id=more-resources>More Resources <a href=#more-resources class=anchor aria-hidden=true>#</a></h2><ol><li><a href=https://www.circonus.com/2018/11/the-problem-with-percentiles-aggregation-brings-aggravation/>The Problem with Percentiles – Aggregation brings Aggravation</a>.</li><li><a href=https://orangematter.solarwinds.com/2016/11/18/why-percentiles-dont-work-the-way-you-think/>Why percentiles don&rsquo;t work the way you think</a>.</li></ol><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=https://cloudprober.org/docs/how-to/validators/><div class="card my-1"><div class="card-body py-2">&larr; Validators</div></div></a><a class=ms-auto href=https://cloudprober.org/docs/how-to/targets/><div class="card my-1"><div class="card-body py-2">Targets &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Website powered by <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://cloudprober.org/js/bootstrap.min.87685cf4e6585276ff9e7b5d0b97e792615af6921e77821315d1ca7c5511ac2f30667e16c0d031e680ca8b57f63f6c0f6c4a232da777cce474b501ed81e090a9.js integrity="sha512-h2hc9OZYUnb/nntdC5fnkmFa9pIed4ITFdHKfFURrC8wZn4WwNAx5oDKi1f2P2wPbEojLad3zOR0tQHtgeCQqQ==" crossorigin=anonymous defer></script>
<script src=https://cloudprober.org/js/highlight.min.6d2ae9724e2da3febf052f9f9979776c542ecb50cd20d7280148c1eef7d0f76d3d84f82b8d3b10a209294618236691747c95c658e350ffac326cde26caf84347.js integrity="sha512-bSrpck4to/6/BS+fmXl3bFQuy1DNINcoAUjB7vfQ9209hPgrjTsQogkpRhgjZpF0fJXGWONQ/6wybN4myvhDRw==" crossorigin=anonymous defer></script>
<script src=https://cloudprober.org/main.min.162c56a0426544de0d010e66c56e321579655c400c9aae06a6823e7682de379adadf2165bd416fea191e4e7e410fbf1fd2c35a759aa43ff2e3787067669bf81b.js integrity="sha512-FixWoEJlRN4NAQ5mxW4yFXllXEAMmq4GpoI+doLeN5ra3yFlvUFv6hkeTn5BD78f0sNadZqkP/LjeHBnZpv4Gw==" crossorigin=anonymous defer></script>
<script src=https://cloudprober.org/index.min.429d73e440bf533e628d9092ccf7f8dbc94dfa7ea90e2ca6c6c1ebc316c9ecb2ab759dc07f34e5b322fb1737908613e78d2b382309cb1de96b517ef037754071.js integrity="sha512-Qp1z5EC/Uz5ijZCSzPf428lN+n6pDiymxsHrwxbJ7LKrdZ3AfzTlsyL7FzeQhhPnjSs4IwnLHelrUX7wN3VAcQ==" crossorigin=anonymous defer></script></body></html>
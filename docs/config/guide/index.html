<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://cloudprober.org/fonts/open-sans/open-sans-v35-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/open-sans/open-sans-v35-latin-italic.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/open-sans/open-sans-v35-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/jost/jost-v14-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/jost/jost-v14-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://cloudprober.org/fonts/jost/jost-v14-latin-italic.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://cloudprober.org/main.b300fbd8bf09758454543ef1943b7fa11daa63ff97c5c212977611a8733e13c4d48fc030119ef65774d3776161304cea10ef9d4f817b6dfb680235d13b6304cd.css integrity="sha512-swD72L8JdYRUVD7xlDt/oR2qY/+XxcISl3YRqHM+E8TUj8AwEZ72V3TTd2FhMEzqEO+dT4F7bftoAjXRO2MEzQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Config Guide - Cloudprober</title><meta name=description content="Cloudprober offers flexible and powerful options to manage the configs. This document details the key features of Cloudprober&amp;rsquo;s configuration system.
Config Language #Cloudprober uses Protocol Buffers (protobufs) as the foundation for its configuration schema. This allows configurations to be written in multiple formats, providing flexibility for different use cases. The supported formats are:
Textproto: A human-readable text format for protobufs, directly aligned with the protobuf schema defined in config.proto. It is straightforward and closely mirrors the underlying structure."><link rel=canonical href=https://cloudprober.org/docs/config/guide/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Config Guide"><meta property="og:description" content="Cloudprober offers flexible and powerful options to manage the configs. This document details the key features of Cloudprober&rsquo;s configuration system.
Config Language #Cloudprober uses Protocol Buffers (protobufs) as the foundation for its configuration schema. This allows configurations to be written in multiple formats, providing flexibility for different use cases. The supported formats are:
Textproto: A human-readable text format for protobufs, directly aligned with the protobuf schema defined in config.proto. It is straightforward and closely mirrors the underlying structure."><meta property="og:url" content="https://cloudprober.org/docs/config/guide/"><meta property="og:site_name" content="Cloudprober"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@cloudprober"><meta name=twitter:creator content="@manugarg"><meta name=twitter:title content="Config Guide"><meta name=twitter:description content><meta name=twitter:card content="summary"><meta name=twitter:image:alt content="Config Guide"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://cloudprober.org/#/schema/organization/1","name":"Cloudprober","url":"https://cloudprober.org/","sameAs":["https://twitter.com/cloudprober","https://github.com/cloudprober/cloudprober"],"logo":{"@type":"ImageObject","@id":"https://cloudprober.org/#/schema/image/1","url":"https://cloudprober.org/\u003cnil\u003e","width":512,"height":512,"caption":"Cloudprober"},"image":{"@id":"https://cloudprober.org/#/schema/image/1"}},{"@type":"WebSite","@id":"https://cloudprober.org/#/schema/website/1","url":"https://cloudprober.org/","name":"Cloudprober","description":"An active\/synthetic monitoring software to reliably detect outages before your customers do.","publisher":{"@id":"https://cloudprober.org/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://cloudprober.org/docs/config/guide/","url":"https://cloudprober.org/docs/config/guide/","name":"Config Guide","description":"","isPartOf":{"@id":"https://cloudprober.org/#/schema/website/1"},"about":{"@id":"https://cloudprober.org/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://cloudprober.org/docs/config/guide/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://cloudprober.org/docs/config/guide/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://cloudprober.org/docs/config/guide/"]}]},{"@type":"BreadcrumbList","@id":"https://cloudprober.org/docs/config/guide/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://cloudprober.org","url":"https://cloudprober.org","name":"Home"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://cloudprober.org/docs/","url":"https://cloudprober.org/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://cloudprober.org/docs/config/","url":"https://cloudprober.org/docs/config/","name":"Config"}},{"@type":"ListItem","position":5,"item":{"@id":"https://cloudprober.org/docs/config/guide/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://cloudprober.org/#/schema/article/1","headline":"Config Guide","description":"","isPartOf":{"@id":"https://cloudprober.org/docs/config/guide/"},"mainEntityOfPage":{"@id":"https://cloudprober.org/docs/config/guide/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://cloudprober.org/#/schema/person/2"},"publisher":{"@id":"https://cloudprober.org/#/schema/organization/1"},"image":{"@id":"https://cloudprober.org/docs/config/guide/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://cloudprober.org/#/schema/person/2","name":"Manu Garg","sameAs":["https://twitter.com/manugarg","https://www.linkedin.com/in/manugarg/","https://github.com/manugarg"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://cloudprober.org/docs/config/guide/#/schema/image/2","url":null,"contentUrl":null,"caption":"Config Guide"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://cloudprober.org/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://cloudprober.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://cloudprober.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://cloudprober.org/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://cloudprober.org/site.webmanifest><script async src="https://www.googletagmanager.com/gtag/js?id=G-FHHPC1TNQV"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FHHPC1TNQV")</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-79661-8","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var buttons=document.querySelectorAll("a"),query;Array.prototype.map.call(buttons,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-action")||"follow";ga("send","event","outbound",t,e.href)})}),query=document.querySelector(".query"),query&&query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script></head><body class="docs single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://cloudprober.org/ aria-label=Cloudprober>Cloudprober</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://cloudprober.org/>Cloudprober</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Get Started
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://cloudprober.org/docs/overview/cloudprober>Overview</a></li><li><a class=dropdown-item href=https://cloudprober.org/docs/overview/getting-started>Getting Started</a></li><li><a class=dropdown-item href=https://cloudprober.org/docs/overview/probe>What is a Probe</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Config
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class="dropdown-item active" href=https://cloudprober.org/docs/config/guide aria-current=true>Config Guide</a></li><li><a class=dropdown-item href=https://cloudprober.org/docs/config/latest/overview>Config Reference</a></li></ul></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/how-to/list/>How-To</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>About
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://cloudprober.org/docs/about/>Origin</a></li><li><a class=dropdown-item href=https://medium.com/cloudprober/>Blog</a></li><li><a class=dropdown-item href=https://github.com/cloudprober/cloudprober/discussions>Github Discussions</a></li><li><a class=dropdown-item href=https://join.slack.com/t/cloudprober/shared_invite/enQtNjA1OTkyOTk3ODc3LWQzZDM2ZWUyNTI0M2E4NmM4NTIyMjM5M2E0MDdjMmU1NGQ3NWNiMjU4NTViMWMyMjg0M2QwMDhkZGZjZmFlNGE>Slack</a></li><li><a class=dropdown-item href=https://x.com/cloudprober>Twitter</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/cloudprober/cloudprober><img src=https://img.shields.io/github/stars/cloudprober/cloudprober alt=GitHub><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/overview/cloudprober>Overview</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/overview/getting-started/>Getting Started</a></li><li><a class=docs-link href=https://cloudprober.org/docs/overview/probe/>What is a Probe</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class="docs-link active" href=https://cloudprober.org/docs/config/guide>Configuration</a></h3><ul class=list-unstyled><li><a class="docs-link active" href=https://cloudprober.org/docs/config/guide/>Config Guide</a></li><li><a class=docs-link href=https://cloudprober.org/docs/config/latest/overview>Config Reference</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/how-to/list/>How-To</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/how-to/external-probe/>External Probe</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/alerting/>Alerting</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/targets/>Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/k8s_targets/>Kubernetes Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/run-on-kubernetes/>Running On Kubernetes</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/additional-labels/>Additional Labels</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/validators/>Validators</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/oauth/>OAuth Based Authentication</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/percentiles/>Percentiles and Histograms</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/extensions/>Extending Cloudprober</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/built-in-servers/>Built-in Servers</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/rds/>Resource Discovery Service</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview/>Exporting Metrics (Surfacers)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/cloudwatch/>Cloudwatch (AWS)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/stackdriver/>Stackdriver (Google Cloud)</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav id=sidebar-default class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/overview/cloudprober>Overview</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/overview/getting-started/>Getting Started</a></li><li><a class=docs-link href=https://cloudprober.org/docs/overview/probe/>What is a Probe</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class="docs-link active" href=https://cloudprober.org/docs/config/guide>Configuration</a></h3><ul class=list-unstyled><li><a class="docs-link active" href=https://cloudprober.org/docs/config/guide/>Config Guide</a></li><li><a class=docs-link href=https://cloudprober.org/docs/config/latest/overview>Config Reference</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/how-to/list/>How-To</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/how-to/external-probe/>External Probe</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/alerting/>Alerting</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/targets/>Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/k8s_targets/>Kubernetes Targets</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/run-on-kubernetes/>Running On Kubernetes</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/additional-labels/>Additional Labels</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/validators/>Validators</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/oauth/>OAuth Based Authentication</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/percentiles/>Percentiles and Histograms</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/extensions/>Extending Cloudprober</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/built-in-servers/>Built-in Servers</a></li><li><a class=docs-link href=https://cloudprober.org/docs/how-to/rds/>Resource Discovery Service</a></li></ul><h3 class="h6 text-uppercase mb-2"><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></h3><ul class=list-unstyled><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/overview/>Exporting Metrics (Surfacers)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/cloudwatch/>Cloudwatch (AWS)</a></li><li><a class=docs-link href=https://cloudprober.org/docs/surfacers/stackdriver/>Stackdriver (Google Cloud)</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#config-language>Config Language</a></li><li><a href=#building-blocks>Building Blocks</a></li><li><a href=#programmability>Programmability</a><ul><li><a href=#go-text-templates>Go Text Templates</a></li><li><a href=#jsonnet-based-programmability>Jsonnet-Based Programmability</a></li></ul></li><li><a href=#useful-inbuilt-functions-and-variables>Useful Inbuilt Functions and Variables</a><ul><li><a href=#sprig-library-functions>Sprig Library Functions</a></li><li><a href=#cloudprober-specific-extensions>Cloudprober-Specific Extensions</a></li></ul></li><li><a href=#splitting-config-into-multiple-files>Splitting Config into Multiple Files</a><ul><li><a href=#using-the-include-directive>Using the <code>include</code> Directive</a></li></ul></li><li><a href=#accessing-configuration-via-webserver>Accessing Configuration via Webserver</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#config-language>Config Language</a></li><li><a href=#building-blocks>Building Blocks</a></li><li><a href=#programmability>Programmability</a><ul><li><a href=#go-text-templates>Go Text Templates</a></li><li><a href=#jsonnet-based-programmability>Jsonnet-Based Programmability</a></li></ul></li><li><a href=#useful-inbuilt-functions-and-variables>Useful Inbuilt Functions and Variables</a><ul><li><a href=#sprig-library-functions>Sprig Library Functions</a></li><li><a href=#cloudprober-specific-extensions>Cloudprober-Specific Extensions</a></li></ul></li><li><a href=#splitting-config-into-multiple-files>Splitting Config into Multiple Files</a><ul><li><a href=#using-the-include-directive>Using the <code>include</code> Directive</a></li></ul></li><li><a href=#accessing-configuration-via-webserver>Accessing Configuration via Webserver</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Config Guide</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#config-language>Config Language</a></li><li><a href=#building-blocks>Building Blocks</a></li><li><a href=#programmability>Programmability</a><ul><li><a href=#go-text-templates>Go Text Templates</a></li><li><a href=#jsonnet-based-programmability>Jsonnet-Based Programmability</a></li></ul></li><li><a href=#useful-inbuilt-functions-and-variables>Useful Inbuilt Functions and Variables</a><ul><li><a href=#sprig-library-functions>Sprig Library Functions</a></li><li><a href=#cloudprober-specific-extensions>Cloudprober-Specific Extensions</a></li></ul></li><li><a href=#splitting-config-into-multiple-files>Splitting Config into Multiple Files</a><ul><li><a href=#using-the-include-directive>Using the <code>include</code> Directive</a></li></ul></li><li><a href=#accessing-configuration-via-webserver>Accessing Configuration via Webserver</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#config-language>Config Language</a></li><li><a href=#building-blocks>Building Blocks</a></li><li><a href=#programmability>Programmability</a><ul><li><a href=#go-text-templates>Go Text Templates</a></li><li><a href=#jsonnet-based-programmability>Jsonnet-Based Programmability</a></li></ul></li><li><a href=#useful-inbuilt-functions-and-variables>Useful Inbuilt Functions and Variables</a><ul><li><a href=#sprig-library-functions>Sprig Library Functions</a></li><li><a href=#cloudprober-specific-extensions>Cloudprober-Specific Extensions</a></li></ul></li><li><a href=#splitting-config-into-multiple-files>Splitting Config into Multiple Files</a><ul><li><a href=#using-the-include-directive>Using the <code>include</code> Directive</a></li></ul></li><li><a href=#accessing-configuration-via-webserver>Accessing Configuration via Webserver</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></nav><p>Cloudprober offers flexible and powerful options to manage the configs. This document details the key features of Cloudprober&rsquo;s configuration system.</p><h2 id=config-language>Config Language <a href=#config-language class=anchor aria-hidden=true>#</a></h2><p>Cloudprober uses Protocol Buffers (protobufs) as the foundation for its configuration schema. This allows configurations to be written in multiple formats, providing flexibility for different use cases. The supported formats are:</p><ul><li><strong>Textproto</strong>: A human-readable text format for protobufs, directly aligned with the protobuf schema defined in <code>config.proto</code>. It is straightforward and closely mirrors the underlying structure. Example: <a href=https://github.com/cloudprober/cloudprober/blob/main/config/testdata/unmarshal_test/cloudprober.cfg>cloudprober.cfg</a></li><li><strong>YAML</strong>: A popular, human-readable format that can be used to define Cloudprober configurations. YAML configs are converted to protobufs internally. Example: <a href=https://github.com/cloudprober/cloudprober/blob/main/config/testdata/unmarshal_test/cloudprober.yaml>cloudprober.yaml</a></li><li><strong>Jsonnet</strong>: A data templating language that allows for more programmatic configuration. Jsonnet configs are also converted to protobufs for processing. Example: <a href=https://github.com/cloudprober/cloudprober/blob/main/config/testdata/unmarshal_test/cloudprober.jsonnet>cloudprober.jsonnet</a></li></ul><p>For example, a simple Cloudprober configuration in YAML might look like this:</p><pre><code class=language-yaml>probe:
  - name: &quot;http_probe&quot;
    type: HTTP
    targets:
      host_names: &quot;www.example.com&quot;
    interval_msec: 5000
</code></pre><p>The same configuration in textproto would be:</p><pre><code class=language-protobuf>probe {
  name: &quot;http_probe&quot;
  type: HTTP
  targets {
    host_names: &quot;www.example.com&quot;
  }
  interval_msec: 5000
}
</code></pre><p>All formats are interchangeable, as they are parsed into the same protobuf structure. Choose the format that best suits your workflow or tooling preferences.</p><h2 id=building-blocks>Building Blocks <a href=#building-blocks class=anchor aria-hidden=true>#</a></h2><p>At its core, a Cloudprober configuration consists of a collection of distinct configuration entries, each serving a specific purpose. Here are the most common entry types:</p><ul><li><strong><a href=https://cloudprober.org/docs/overview/probe>Probes</a></strong>: Probes are Cloudprober&rsquo;s primary building blocks. Most of the time you&rsquo;ll be working with these. Each probe entry defines a probe that Cloudprober will execute to monitor your systems. All probes have some common fields like <em>type</em>, <em>name</em>, <em>targets</em>, <em>interval</em>, <em>alert</em>, etc and some probe-type specific fields, e.g. HTTP probes have fields like <em>url</em>, <em>method</em>, etc. See <a href=https://cloudprober.org/docs/config/latest/probes>probes config reference</a> for more details on actual fields.</li><li><strong><a href=https://cloudprober.org/docs/surfacers/overview>Surfacers</a></strong>: Surfacers are responsible for exporting probe results to various monitoring systems (e.g., Prometheus, Stackdriver). It&rsquo;s uncommon to have more than one surfacer, and in most cases specifying no explicit surfacer, hence relying on the default surfacer works very well.</li><li><strong><a href=https://cloudprober.org/docs/how-to/built-in-servers/>Servers</a></strong>: These are very rare. You add servers if you want Cloudprober to act as targets (yes, you can do that). This is typically used to monitor network and load balancers.</li></ul><h2 id=programmability>Programmability <a href=#programmability class=anchor aria-hidden=true>#</a></h2><p>Cloudprober configurations support programmability to enable dynamic and reusable configs. This is achieved through two primary mechanisms:</p><h3 id=go-text-templates>Go Text Templates <a href=#go-text-templates class=anchor aria-hidden=true>#</a></h3><p>Cloudprober integrates <a href=https://pkg.go.dev/text/template>Go text templates</a> to add programming capabilities like loops and conditionals. These templates allow you to dynamically generate configurations based on variables or logic. For example, you can use loops to create multiple probes with similar configurations or conditionals to include specific settings based on environment variables.</p><p>Example of a Go text template with a loop:</p><pre><code class=language-protobuf>{{ range $host := (list &quot;cloudprober.org&quot; &quot;pagenotes.manugarg.com&quot;) }}
probe {
  name: &quot;probe_{{ $host }}&quot;
  type: HTTP
  targets {
    host_names: &quot;{{ $host }}&quot;
  }
  interval_msec: 5000
}
{{ end }}
</code></pre><h3 id=jsonnet-based-programmability>Jsonnet-Based Programmability <a href=#jsonnet-based-programmability class=anchor aria-hidden=true>#</a></h3><p>When using Jsonnet as the configuration format, you gain access to Jsonnet&rsquo;s native programmability features, such as functions, variables, and conditionals. This is particularly useful for complex configurations that require reusable logic or abstraction. Jsonnet&rsquo;s features are automatically available when you write your config in Jsonnet, eliminating the need for additional templating.</p><p>Example of a Jsonnet config:</p><pre><code class=language-jsonnet>local probeTemplate(name, host) = {
  probe: [{
    name: name,
    type: 'HTTP',
    targets: {
      host_names: host,
    },
    interval_msec: 5000,
  }],
};

probeTemplate('http_probe', 'www.example.com')
</code></pre><p>Jsonnet&rsquo;s flexibility makes it ideal for generating configurations programmatically, especially in large-scale deployments.<a href=https://github.com/cloudprober/cloudprober/blob/master/config/proto/config.proto></a><a href="https://news.ycombinator.com/item?id=35325488"></a></p><h2 id=useful-inbuilt-functions-and-variables>Useful Inbuilt Functions and Variables <a href=#useful-inbuilt-functions-and-variables class=anchor aria-hidden=true>#</a></h2><p>Cloudprober enhances Go text templates with additional functions and variables, including those provided by the <a href=https://masterminds.github.io/sprig/>Sprig library</a> and custom Cloudprober-specific extensions.</p><h3 id=sprig-library-functions>Sprig Library Functions <a href=#sprig-library-functions class=anchor aria-hidden=true>#</a></h3><p>Cloudprober incorporates the <a href=https://masterminds.github.io/sprig/>Sprig library</a>, which provides over 100 functions for string manipulation, lists, math, date handling, and more. These functions can be used within Go text templates to add advanced logic to your configurations. Examples include:</p><ul><li><code>toUpper</code>: Converts a string to uppercase.</li><li><code>randAlphaNum</code>: Generates a random alphanumeric string.</li><li><code>date</code>: Formats a date or time.</li></ul><p>Example using Sprig functions:</p><pre><code class=language-protobuf>{{ $host := &quot;web1&quot; }}
probe {
  name: &quot;{{ $host | toUpper }}&quot;
  type: HTTP
  targets {
    host_names: &quot;{{ $host }}&quot;
  }
  interval_msec: {{ 5000 + (randInt 1 1000) }}
}
</code></pre><p>In this example, <code>toUpper</code> capitalizes the probe name, and <code>randInt</code> adds a random interval offset.</p><h3 id=cloudprober-specific-extensions>Cloudprober-Specific Extensions <a href=#cloudprober-specific-extensions class=anchor aria-hidden=true>#</a></h3><p>Cloudprober provides custom template extensions, defined in <a href=https://github.com/cloudprober/cloudprober/blob/main/config/config_tmpl.go>config_tmpl.go</a>, to support specific use cases. A key extension is <code>configDir</code> variable, which retrieves the directory of the current configuration file. This is useful for referencing additional files relative to the config file&rsquo;s location.</p><p>Example using <code>configDir</code>:</p><pre><code class=language-protobuf>probe {
  name: &quot;file_based_probe&quot;
  type: HTTP
  targets {
    file_targets {
      file_path: &quot;{{ configDir }}/targets.textpb&quot;
      re_eval_sec: 300
    }
  }
}
</code></pre><p>Here, <code>configDir</code> resolves to the directory of the config file, allowing you to reference a <code>targets.textpb</code> file in the same directory. Other Cloudprober-specific functions include utilities to access GCE Custom Metadata and declare secret environment variables that don&rsquo;t show up in the web interface.</p><h2 id=splitting-config-into-multiple-files>Splitting Config into Multiple Files <a href=#splitting-config-into-multiple-files class=anchor aria-hidden=true>#</a></h2><p>Cloudprober supports splitting configurations across multiple files using the <code>include</code> directive, which is particularly useful for modularizing large configurations. This allows you to organize probes, targets, or other settings into separate files for better maintainability.</p><h3 id=using-the-include-directive>Using the <code>include</code> Directive <a href=#using-the-include-directive class=anchor aria-hidden=true>#</a></h3><p>The <code>include</code> directive can be used to import content from other files. For example, you can define common probes in separate files and include them in your main configuration.</p><p>NOTE: <code>include</code> doesn&rsquo;t work very well with yaml files.</p><p>Example directory structure:</p><pre><code>cloudprober/
├── cloudprober.cfg
├── probes/
│   ├── http_probe.cfg
│   ├── dns_probe.cfg
</code></pre><p>Main configuration (<code>cloudprober.cfg</code>):</p><pre><code class=language-proto>include &quot;probes/http_probe.cfg&quot;
include &quot;probes/dns_probe.cfg&quot;
</code></pre><p>Example <code>probes/http_probe.cfg</code>:</p><pre><code class=language-proto>probe {
  name: &quot;http_probe&quot;
  type: HTTP
  ...
}
</code></pre><p>The <code>include</code> directive reads the content of <code>http_probe.cfg</code> and inserts it into the main config. This approach allows you to reuse probe definitions across multiple configurations or environments.</p><p>For a practical example, see the Cloudprober repository&rsquo;s <strong><a href=https://github.com/cloudprober/cloudprober/tree/main/examples/include>examples/include</a></strong> directory, which demonstrates how to structure and use multiple configuration files.</p><h2 id=accessing-configuration-via-webserver>Accessing Configuration via Webserver <a href=#accessing-configuration-via-webserver class=anchor aria-hidden=true>#</a></h2><p>Cloudprober provides a webserver interface to access the current configuration in different forms, which is useful for debugging. The following endpoints are available on the Cloudprober webserver (typically accessible at <code>http://&lt;cloudprober-host>:9313</code>):</p><ul><li><p><strong><code>/config-running</code></strong>: Displays the parsed and running configuration, reflecting the final state of the configuration after all templates (e.g., Go text templates or Jsonnet) and <code>include</code> directives have been processed and config has been converted to protobufs. This is the actual configuration being used by Cloudprober at runtime.</p></li><li><p><strong><code>/config-parsed</code></strong>: Shows the parsed configuration after processing templates and includes, but before converting to protobufs. This will be more readable and familiar than what you get from <code>/config-running</code>.</p></li><li><p><strong><code>/config</code></strong>: Returns the raw, unprocessed configuration as provided to Cloudprober (e.g., the original textproto, YAML, or Jsonnet file). This is useful for verifying that cloudprober is reading the correct config file.</p></li></ul><p>Example usage:</p><pre><code class=language-bash>curl http://localhost:9313/config-parsed
</code></pre><h2 id=conclusion>Conclusion <a href=#conclusion class=anchor aria-hidden=true>#</a></h2><p>Cloudprober&rsquo;s configuration system, built on protobufs, offers flexibility through multiple formats (textproto, YAML, Jsonnet) and powerful programmability via Go text templates and Jsonnet. The integration of Sprig and Cloudprober-specific extensions, like <code>configDir</code>, enhances dynamic configuration capabilities. Splitting configs into multiple files using the <code>include</code> directive further improves modularity and maintainability.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=https://cloudprober.org/docs/surfacers/cloudwatch/><div class="card my-1"><div class="card-body py-2">&larr; Cloudwatch (AWS)</div></div></a><a class=ms-auto href=https://cloudprober.org/docs/surfacers/overview/><div class="card my-1"><div class="card-body py-2">Exporting Metrics (Surfacers) &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Website powered by <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://cloudprober.org/js/bootstrap.min.87685cf4e6585276ff9e7b5d0b97e792615af6921e77821315d1ca7c5511ac2f30667e16c0d031e680ca8b57f63f6c0f6c4a232da777cce474b501ed81e090a9.js integrity="sha512-h2hc9OZYUnb/nntdC5fnkmFa9pIed4ITFdHKfFURrC8wZn4WwNAx5oDKi1f2P2wPbEojLad3zOR0tQHtgeCQqQ==" crossorigin=anonymous defer></script>
<script src=https://cloudprober.org/js/highlight.min.6d2ae9724e2da3febf052f9f9979776c542ecb50cd20d7280148c1eef7d0f76d3d84f82b8d3b10a209294618236691747c95c658e350ffac326cde26caf84347.js integrity="sha512-bSrpck4to/6/BS+fmXl3bFQuy1DNINcoAUjB7vfQ9209hPgrjTsQogkpRhgjZpF0fJXGWONQ/6wybN4myvhDRw==" crossorigin=anonymous defer></script>
<script src=https://cloudprober.org/main.min.162c56a0426544de0d010e66c56e321579655c400c9aae06a6823e7682de379adadf2165bd416fea191e4e7e410fbf1fd2c35a759aa43ff2e3787067669bf81b.js integrity="sha512-FixWoEJlRN4NAQ5mxW4yFXllXEAMmq4GpoI+doLeN5ra3yFlvUFv6hkeTn5BD78f0sNadZqkP/LjeHBnZpv4Gw==" crossorigin=anonymous defer></script>
<script src=https://cloudprober.org/index.min.eb1632fdac49f9f2a381841e5bbcd5a2c93256e4f4663463993ae544ca0725885c363aceb1612996046f3823c7642f6570fe6fed82fe3256b8d3497a1b729d3f.js integrity="sha512-6xYy/axJ+fKjgYQeW7zVoskyVuT0ZjRjmTrlRMoHJYhcNjrOsWEplgRvOCPHZC9lcP5v7YL+Mla400l6G3KdPw==" crossorigin=anonymous defer></script></body></html>